<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="yecol">
        <title>
            百度健康公益联盟
        </title>
        <link href="/static/assets/css/form.css" rel="stylesheet" type="text/css">
        <link href="/static/assets/css/style.css" rel="stylesheet" type="text/css">

        <!--[if lt IE 9]>
        <script src="/static/assets/js/html5shiv.js"></script>
        <script src="/static/assets/js/respond.min.js"></script>
        <![endif]-->
        <style type="text/css">
        .fixer{
            position:fixed; 
            padding-top: 20px;
            z-index: 700;
            width: 100%;
            _position:absolute;
            _top:expression(documentElement.scrollTop+30 + "px")
        }
        .tip{
            position:absolute;
            top: 20px;
            z-index: 900;
            width: 100%;
            _position:absolute;
            _top:expression(documentElement.scrollTop+30 + "px")
        }      

        .errorHint {color: #CC0000;}
        </style>
    </head>
    
    <body>
        <div class="fixer">
        <div id="nav">
            <div class="nav-lp">
            <ul>
                <li id="l1"><a href="#top" id="ftop">首页</a></li>
                <li id="l2"><a href="#focus" id="ffocus" class="active">焦点救助</a></li>
                <li id="l3"><a href="#union" id="funion">健康公益联盟</a></li>
            </ul>
            </div>
            <div class="nav-rp">
            <a id="nav-btn" class="req-help"></a>
            </div>
        </div>
        </div>
        <div class="header" id="top">
            <ul>
                <li class="active"><a href="#" class="active">首页</a></li>
                <li><a href="/focus/" >焦点救助</a></li>
                <li><a href="/union/" >联盟公约</a></li>
            </ul>
        </div>

        <div class="section" id="cover">
            <div class="container">
                <div class="title1">
                    <h1>百度健康公益联盟</h1>
                    <h3>关爱凝聚力量 平等成就健康</h3>
                </div>
                <div class="primary">
                    <a href="#" id="pr-btn" class="req-help"></a>
                </div>
                <div class="detail">
                    近万家医疗机构 已加入百度健康公益联盟
                    <hr>
                </div>

                <div class="title2">
                    <div class="t2l">
                        <p><strong>百度健康公益联盟是全球最大的医疗公益专业平台</strong></p>
                        <p><span class="cc1">参与的医疗结构最多：</span>国内上万家医疗机构</p>
                        <p><span class="cc2">投入资源最多：</span>十年内投入50亿医疗资源</p>
                        <p><span class="cc3">直接覆盖范围最广：</span>参与的医疗机构覆盖上千个县市</p>
                    </div>
                    <div class="t2r"><p>百度健康公益联盟，是由百度发起并联合国内上万家医疗机构共同搭建的专业医疗公益平台。宗旨是为具有爱心的医疗机构与经济困难且需要社会救助的患者群体牵线搭桥，使这些患者与爱心医疗机构形成一对一的救助关系，进而让缺乏医疗条件但又真正需要医疗救助的弱势群体拥有平等的健康权利。</p></div>
                </div>

            </div>
        </div>

        <div class="section" id="focus" name="sn2">
            <div class="container">
            <div class="mid-container" id="fmc">
            <div class="title">
            <div class="title1">焦点救助</div>
            </div>   
            <div class="frame">
                <div class="image"><a href="/focus/"><img src="/static/img/pic_1.jpg"></a></div>
                <div class="content">
                    <h3 id="cutoff1"><a href="/focus/">北京市老年疾病救助公益活动北京市老年疾病救助公益活动北京市老年疾病救助公益活动</a></h3>
                    <p id="cutoff2">主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述描述主题救助活动描述主题救助活动描述主题救主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述描述主题救助活动描述主题救助活动描述主题救主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述描述主题救助活动描述主题救助活动描述主题救主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述描述主题救助活动描述主题救助活动描述主题救主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述主题救助活动描述描述主题救助活动描述主题救助活动描述主题救</p>
                    <p class="mr20" id="cutoff3"><span class="s">参与救助机构：</span>中国红十字会，中国红十字会，中国红十字会，中国红十字会，中国红十字会,中国红十字会，中国红十字会，中国红十字会,中国红十字会，中国红十字会，中国红十字会,中国红十字会，中国红十字会，中国红十字会
                    <p class="mr20"><span class="s">参与医院：</span>共&nbsp;<span class="cc5">23</span>&nbsp;家民营医院</p>
                </div>
                <div class="status">
                    <div class="tag">
                        <a href="/focus/" class="taga">
                        <!-- TODO:填写所有状态，有几个填写几个。tgtext2l为两行文字,tgtext1l为一行文字 -->
                        <div class="tgtext tgtext2l">
                        <p><span class="p60">当前进展：</span><span class="f24">状态1</span></p>
                        <p><span class="p60">已救助：</span><span class="f24">1111人</span></p>
                        </div>
                        <div class="tgtext tgtext2l">
                        <p><span class="p60">当前进展：</span><span class="f24">状态状态状态状态状态状态状态状态状态状态</span></p>
                        <p><span class="p60">已救助：</span><span class="f24">状态状态状态状态状态状态人</span></p>
                        </div>
                        <div class="tgtext tgtext1l">
                        <p><span class="p60">当前进展：</span><span class="f24">救助中救助中救助中救助中救助中救助中</span></p>
                        </div>
                        <div class="tgtext tgtext1l">
                        <p><span class="p60">当前进展：</span><span class="f24">救助中</span></p>
                        </div>
                        <div class="next"></div>
                        </a>
                    </div>
                    <!-- TODO:数字序号写在这里，如这里表示激活第3个 -->
                    <div id="cura" class="hide">3</div>

                    <div class="tail">
                    </div>
                    <div class="line">
                        <a class="stage1"></a>
                        <div class="seg"></div>
                        <a class="stage"></a>
                        <div class="seg"></div>
                        <a class="stage"></a>
                        <div class="seg"></div>
                        <a class="stage"></a>
                        <div class="seg"></div>
                    </div>
                    <!-- TODO:填写状态，有几个写几个 -->
                    <div class="segtext">
                        <div class="seg-t" id="st1"><p>好了么打发打发打算费大幅地方倒萨</p><p>2013-10-11</p></div>
                        <div class="seg-t" id="st2"><p>开始</p><p>2013-10-11</p></div>
                        <div class="seg-t" id="st3"><p>开始</p><p>2013-10-11</p></div>
                        <div class="seg-t" id="st4"><p>开始</p><p>2013-10-11</p></div>
                    </div>
                </div>
            </div>
            </div>   
            </div>
        </div>

        <div class="section" id="union" name="sn3">
            <div class="container">
            <div class="mid-container">
            <div class="title">
            <div class="title1">健康公益联盟<a class="seeall" href="/union/">联盟公约</a></div>
            </div> 
            <div class="face-frame">
                <ul>
                    <!-- line1 -->
                    <li class="face2" id="f1"><img src="/static/img/face-1.jpg"></li>
                    <li class="face1" id="f2"><img src="/static/img/face-1.jpg"></img></li>
                    <li class="face1" id="f3"><img src="/static/img/face-1.jpg"></img></li>
                    <li class="face1" id="f4"><img src="/static/img/face-1.jpg"></img></li>
                    <li class="facew" id="f5"><img src="/static/img/face-1.jpg"></li>
                    <!-- line2 -->
                    <li class="face1" id="f6"><img src="/static/img/face-1.jpg"></img></li>
                    <li class="face2" id="f7"><img src="/static/img/face-1.jpg"></li>
                    <li class="facew" id="f8"><img src="/static/img/face-1.jpg"></li>
                    <!-- line3 -->
                    <li class="face2" id="f9"><img src="/static/img/face-1.jpg"></li>
                    <li class="face1" id="f10"><img src="/static/img/face-1.jpg"></li>
                    <li class="facew" id="f11"><img src="/static/img/face-1.jpg"></li>
                    <!-- line4 -->
                    <li class="face1" id="f12"><img src="/static/img/face-1.jpg"></img></li>
                    <li class="facew" id="f13"><img src="/static/img/face-1.jpg"></li>
                    <li class="facew" id="f14"><img src="/static/img/face-1.jpg"></li>
                </ul>
                
            </div>
            </div>   
            </div>
        </div>

        <div class="section" id="footer">
            <p>©2013 Baidu <a href="http://www.baidu.com/duty/">使用百度必读</a> 国家药监局：（京）-经营性-2012-0009</p>
        </div>


        <!-- TODO 加入在此加入所有轮换图片-->
        <div id="preload-1">
            <!-- 加入1*1 -->
            <img src="/static/img/uimg_1.png"></img>
            <img src="/static/img/uimg_2.png"></img>
            <img src="/static/img/uimg_3.png"></img>
            <img src="/static/img/uimg_4.png"></img>
        </div>

        <div id="preload-2">
            <!-- 加入2*2 -->
            <img src="/static/img/uimg_1.png"></img>
            <img src="/static/img/uimg_2.png"></img>
            <img src="/static/img/uimg_3.png"></img>
            <img src="/static/img/uimg_4.png"></img>
            <img src="/static/img/uimg_5.png"></img>
            <img src="/static/img/uimg_6.png"></img>
            <img src="/static/img/uimg_7.png"></img>
        </div>

        <div id="preload-w">
            <!-- 加入1*2 -->
            <img src="/static/img/w_1.png"></img>
            <img src="/static/img/w_2.png"></img>
            <img src="/static/img/w_3.png"></img>
            <img src="/static/img/w_4.png"></img>
            <img src="/static/img/w_5.png"></img>
        </div>


        <!-- Modal -->
        <div class="modal fade" id="yModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">申请救助</h4>
              </div>
              <div class="modal-body">

<form class="form-horizontal" id="help-form" role="form">

    <div class="ygroup">
        <label for="username" class="label-1"><span class="cred">*</span>姓名:</label>
            <div class="col-xs-4"><input type="text" id="username" name="name" class="form-control" data-validate="required" data-validate-max-length="32" >
                <div class="errorHint"></div>
            </div>
        <label for="tel" class="label-2"><span class="cred">*</span>电话:</label>
            <div class="col-xs-4">
                <input type="text" id="tel" class="form-control" name="tel" data-validate="telnumber">
                <div class="errorHint"></div>
            </div>
    </div>

    <div class="ygroup">
         <label for="address" class="label-1"><span class="cred">*</span>地址:</label>
            <div class="col-xs-3">
                <select class="form-control" id="provjs" name="province" type="text" data-validate="require-select-valid-option">
                  <option value='-1'>请选择</option>
                </select>
                <div class="errorHint"></div>
            </div>
            <div class="col-xs-3">
                <select class="form-control" id="cityjs" name="city" type="text">
                  <option value='-1'>请选择</option>
                </select>
            </div>
            <div class="col-xs-3">
                <select class="form-control" id="cotyjs" name="country" type="text">
                  <option value='-1'>请选择</option>
                </select>
            </div>
    </div>

    <div class="ygroup">
        <label for="detailaddress" class="label-1"><span class="cred">*</span>详细地址:</label>
        <div class="col-sm-10">
            <input class="longinput" id="detailaddress" name="address" data-validate="required-none">
            <div class="errorHint"></div>
        </div>
    </div>
    <div class="ygroup">
        <label for="desc" class="label-1"><span class="cred">*</span>病情描述:</label>
        <div class="col-sm-10">
            <textarea class="form-control" rows="3" name="illness_desc" data-validate="required-none"></textarea>
            <div class="errorHint"></div>
        </div>
    </div>
    <div class="ygroup">
        <label for="other" class="label-1">备注:</label>
        <div class="col-sm-10">
            <textarea class="form-control" rows="3" name="remarks"></textarea>
        </div>
    </div>

  <div class="ygroup">
    <div class="col-sm-offset-2 col-sm-10">
        <label>带<span class="cred">*</span>为必填项</label>
    </div>
  </div>
  <div class="ygroup">
    <div class="pull-center">
      <button type="submit" class="send-help"></button>
    </div>
  </div>
</form>

              </div>
            </div><!-- /.modal-content -->
          </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->

<div class="tip"></div>

        <script src="/static/assets/js/jquery-1.10.2.min.js"></script>
        <script src="/static/assets/js/bootstrap.min.js"></script>

        <!-- 输入校验 -->
        <script src="/static/backbone/backbone-1.0.0.min.js"></script>
        <script src="/static/js/system.js"></script>
        <script src="/static/js/validate.js"></script>
        <!-- 输入校验 -->

        <script>
        $fposito = 0;
        $temph = 0;
        $pt = 0;

        $findex1 = 0;
        $findex2 = 0;
        $findexw = 0;
        $pswIndex = 1;

        function subText(selectString,limit,ellipsis){
            if ($(selectString).html().length>limit){
                var txt = $(selectString).html().substr(0,limit);
                $(selectString).html(ellipsis?txt+"…":txt);                
            }
        }

        function multiSubText(selectString,limit,ellipsis){
            $(selectString).each(function(){
                if ($(this).html().length>limit){
                    console.log("hello");
                    var txt = $(this).html().substr(0,limit);
                    $(this).html(ellipsis?txt+"…":txt);               
                }
            });
        }

        $(document).ready(function() {

            /* 截断 */
            subText("#cutoff1 a",12,true);//焦点救助标题
            subText("#cutoff2",90,true);//焦点救助内容
            subText("#cutoff3",70,true);//焦点救助机构
            multiSubText(".tgtext2l .f24",7,false);//状态蓝条
            multiSubText(".tgtext1l .f24",4,false);//状态蓝条
            multiSubText(".seg-t p:nth-child(1)",6,false);//状态下部分
            /* resize section */
            $vsbheight = $(window).height();
            if($vsbheight>$("#focus").height()){
                $("#focus").height($vsbheight);
                $pt = ($("#focus").height()-494)/2
                $("#focus .container").css({"padding-top":$pt,"padding-bottom":$pt,"background-position":"70px "+parseInt($pt+10,0)+"px"});
                $temph=$pt+10;
            }
            /* scroll */
            $("#nav ul a").click(function(e) {
                var sel = $(this).attr("href");
                $('html,body').animate({scrollTop: $(sel).offset().top}, 500);
                e.preventDefault();
            });
            /*slide*/
            $cura = parseInt($("#cura").html(),10)-1;
            $taila=[6,78,152,225];
            {   
                $(".stage").each(function(i){
                    if(i==$cura-1){
                        $(this).addClass('active');
                    }else if(i>$cura-1){
                        $(this).addClass('unactive');
                    }
                    i++;
                });
                $(".seg").each(function(j){
                    if(j+1>$cura){
                        $(this).addClass('unactive');
                    }else{
                        $(this).removeClass('unactive');
                    }
                    j++;
                });
                $(".seg-t").each(function(k){
                    if(k!=$cura){
                        $(this).hide();
                    }else{
                        $(this).show();
                    }
                    k++;
                });
                $(".tgtext").each(function(k){
                    if(k!=$cura){
                        $(this).hide();
                    }else{
                        $(this).show();
                    }
                    k++;
                });
                $(".tail").css("background-position",$taila[$cura]+"px 0px");
                if($cura==0){
                    $(".stage1").addClass('active');
                }
            }

            var timer = null;
            /*slide hover||click*/
            $(".stage,.stage1").hover(function() {
                $curStage = $(this);
                clearTimeout(timer);
                // timer = setTimeout(function() {
                    if($cura==0)return;
                    if($curStage.hasClass('unactive'))return;
                    $(".tail").css("background-position",$taila[$curStage.index()/2]+"px 0px");
                    //$(this).addClass('active');
                    //$(this).siblings('.active').removeClass('active');
                    $index_2=$curStage.index()/2;
                    $(".seg-t").each(function(k){
                        if(k!=$index_2){
                            $(this).hide();
                        }else{
                            $(this).show();
                        }
                        k++;
                    });
                    $(".tgtext").each(function(k){
                        if(k!=$index_2){
                            $(this).hide();
                        }else{
                            $(this).show();
                        }
                        k++;
                    });
                // }, 1000);
            }
            , function() {
                clearTimeout(timer);
                timer = setTimeout(function() {
                    /* 恢复当前状态的效果 */
                    $(".tail").css("background-position",$taila[$cura]+"px 0px");
              
                    //TODO 找到当前状态element的index
                    $(".seg-t").each(function(k){
                        if (k!=$cura) {
                            $(this).hide();
                        } else {
                            $(this).show();    
                        }
                        k++;
                    });
                    $(".tgtext").each(function(k){
                        if(k!=$cura){
                            $(this).hide();
                        }else{
                            $(this).show();
                        }
                        k++;
                    });
                }, 300);
            }
            );

            /*省市县的获取*/
            $prourl="/location/api/provinces/";
            $ctyurl="country.json";
            $.getJSON( $prourl, function(response){
                $options = "<option value='-1'>请选择</option>";
                $.each(response.data, function( key, val ) {
                    $options+=( "<option value='" + key + "'>" + val + "</option>" );
                });
                $("#provjs").html($options);
            });

            $("#provjs").change(function(){
                var provinceId = $("#provjs option:selected").attr('value');
                $citurl = '/location/api/cities/'+provinceId+'/';

                //修改文字
                $.getJSON( $citurl, function(response){
                    $options = "<option value='-1'>请选择</option>";
                    $.each(response.data, function( key, val ) {
                        $options+=( "<option value='" + key + "'>" + val + "</option>" );
                    });
                    $("#cityjs").html($options);
                });
                $("#detailaddress").val($("#provjs option:selected").html());
                $("#cotyjs").html("<option value='-1'>请选择</option>");
            });

            $("#cityjs").change(function(){
                var cid = $("#cityjs option:selected").attr('value');
                $ctyurl = '/location/api/districts/'+cid+'/';

                //修改文字
                $.getJSON( $ctyurl, function(response){
                    $options = "<option value='-1'>请选择</option>";
                    $.each(response.data, function( key, val ) {
                        $options+=( "<option value='" + key + "'>" + val + "</option>" );
                    });
                    $("#cotyjs").html($options);
                });
                $("#detailaddress").val($("#provjs option:selected").html()+$("#cityjs option:selected").html());
            });

            $("#cotyjs").change(function(){
                $("#detailaddress").val($("#provjs option:selected").html()+$("#cityjs option:selected").html()+$("#cotyjs option:selected").html()); 
            })

            /*表单数据传输和处理*/
            /* open form*/
            $(".req-help").click(function(e) {
                /* Act on the event */
                e.preventDefault();
                $("#help-form")[0].reset();

                $('div[class="errorHint"]').each(function() {
                    $(this).text('');
                })
                $('#yModal').modal();
            });

            $(".send-help").click(function(e) {
                if (!W.validate()) {
                    return false;
                }

                e.preventDefault();
                
                $("#yModal").modal('hide');
                //发送数据
                $.ajax({
                    type:"POST",
                    url: "/cms/applications/api/create/",
                    data: $("#help-form").serialize(),
                    success: function(data){              
                        if (data) {//TODO: 需要对错误提交做什么处理？
                            $(".tip").css("top",$(window).scrollTop()+$(window).height()/2).show();
                            setTimeout(function(){
                                $('.tip').hide();
                            }, 2000);
                        };
                    }
                });        
            });
        });
        $(window).resize(function(event) {
            /* resize section */
            $vsbheight = $(window).height();
            if($vsbheight>$("#focus").height()){
                $("#focus").height($vsbheight);
                $pt = ($("#focus").height()-494)/2
                $("#focus .container").css({"padding-top":$pt,"padding-bottom":$pt,"background-position":"70px "+parseInt($pt+10,0)+"px"});
                $temph=$pt+10;
            }
            $('.fixer').css('padding-left',($('#fmc').offset().left+475)); 
        });

        var imageTimer = null;
        var firstTime = 0;
        $(window).scroll(function(){
            var h_num=$(window).scrollTop();
            
            if(h_num>=$("#focus").offset().top+$pt-60){
                //alert($temph);
                $num=parseInt(h_num-($("#focus").offset().top)-$pt+30,10)+parseInt($temph, 10);
                $("#focus .container").css("background-position","70px "+$num +"px");
            }else{
                $pt = ($("#focus").height()-494)/2
                $("#focus .container").css({"padding-top":$pt,"padding-bottom":$pt,"background-position":"70px "+parseInt($pt+10,0)+"px"});
            }

            if(h_num>=$("#union").offset().top+80-60){
                $num=parseInt(h_num-($("#union").offset().top)+60,10);
                $("#union .container").css("background-position","70px "+$num +"px");
            }else{
                $("#union .container").css("background-position","70px 80px");
            }

            if(h_num>=$("#focus").offset().top){
                $('.fixer').css('padding-left',($('#fmc').offset().left+475)); 
                $('#ffocus').addClass('active');
                $('#funion').removeClass('active');
                if (h_num>=$("#union").offset().top) {
                    $('#ffocus').removeClass('active');
                    $('#funion').addClass('active');
                };
                $('.fixer').show();
                $('#nav').show(); 
            }else{ 
                $('.fixer').hide();
                $('#nav').hide();    
            }

            // switch images
            if(h_num>=$("#union").offset().top-400&&firstTime==0){
                firstTime = 1;
                clearTimeout(imageTimer);
                imageTimer = setInterval(function(){

                    // var count = 0;
                    // var interv = setInterval(function() {
                    //     count++;
                    //     if(count>6){
                    //         clearInterval(interv);
                    //     }
                    var $swIndex = 1 + Math.floor(Math.random() * 14);
                    var $curli = $(".face-frame ul li:nth-child("+$swIndex+")");
                    var $swImageUrl = null;
                    if ($curli.hasClass("face1")){
                        //$swImageUrl = "/static/img/uimg_2.png";
                        $findex1 = ($findex1)%$("#preload-1 img").size()+1;
                        $swImageUrl = $("#preload-1 img:nth-child("+$findex1+")").attr('src');
                    }
                    if ($curli.hasClass("face2")){
                        $findex2 = ($findex2)%$("#preload-2 img").size()+1;
                        $swImageUrl = $("#preload-2 img:nth-child("+$findex2+")").attr('src');
                        // console.log("findex2="+$findex2);
                    }
                    if ($curli.hasClass("facew")){
                        $findexw = ($findexw)%$("#preload-w img").size()+1;
                        $swImageUrl = $("#preload-w img:nth-child("+$findexw+")").attr('src');
                        // console.log("findexw="+$findexw);
                    }
                    var swimage = $(".face-frame ul li:nth-child("+$swIndex+") img");
                        swimage.fadeOut(400, function () {
                            swimage.attr('src', $swImageUrl);
                            swimage.fadeIn(400);
                        });
                    // },200);


                } ,4000);
            }else if(h_num<$("#union").offset().top-400){
                firstTime = 0;
            }
        });  
        </script>

        <script type="text/javascript">
            var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
            document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F6b83942048be2f98b58cb7e82a710c44' type='text/javascript'%3E%3C/script%3E"));
        </script>
  </body>
</html>